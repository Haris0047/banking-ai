{
  "query_pairs": [
    {
      "question": "how much did i spent on the dining?",
      "sql": "SELECT sum(amount_aed) AS total_spent_aed FROM transactions t JOIN accounts a ON t.account_id = a.account_id WHERE a.user_id = 1 AND t.direction = 'debit' AND t.merchant_category = 'Dining';"
    },
    {
      "question": "How many users are registered?",
      "sql": "SELECT COUNT(*) FROM users;"
    },
    {
      "question": "Show all user emails.",
      "sql": "SELECT email FROM users;"
    },
    {
      "question": "What is the creation date for each user?",
      "sql": "SELECT user_id, created_at FROM users;"
    },
    {
      "question": "How many accounts does each user have?",
      "sql": "SELECT user_id, COUNT(*) AS num_accounts FROM accounts GROUP BY user_id;"
    },
    {
      "question": "List the account names and types for user ID 1.",
      "sql": "SELECT account_name, account_type FROM accounts WHERE user_id = 1;"
    },
    {
      "question": "What is the total starting balance across all accounts?",
      "sql": "SELECT SUM(starting_balance) FROM accounts;"
    },
    {
      "question": "Count accounts by account type.",
      "sql": "SELECT account_type, COUNT(*) FROM accounts GROUP BY account_type;"
    },
    {
      "question": "What is the total amount of all transactions?",
      "sql": "SELECT SUM(amount) FROM transactions;"
    },
    {
      "question": "How many transactions occurred in January 2024?",
      "sql": "SELECT COUNT(*) FROM transactions WHERE occurred_at BETWEEN '2024-01-01' AND '2024-01-31';"
    },
    {
      "question": "List the top 5 merchants by number of transactions.",
      "sql": "SELECT merchant_name, COUNT(*) AS txn_count FROM transactions WHERE merchant_name IS NOT NULL GROUP BY merchant_name ORDER BY txn_count DESC LIMIT 5;"
    },
    {
      "question": "Show total debit and credit amounts.",
      "sql": "SELECT direction, SUM(amount) FROM transactions GROUP BY direction;"
    },
    {
      "question": "How many distinct transaction types are there?",
      "sql": "SELECT COUNT(DISTINCT txn_type) FROM transactions;"
    },
    {
      "question": "Get the end balance for account 1 on 2024-01-03.",
      "sql": "SELECT end_balance FROM daily_account_value WHERE account_id = 1 AND date = '2024-01-03';"
    },
    {
      "question": "List daily balances for account 1 between January 1 and January 5.",
      "sql": "SELECT date, start_balance, end_balance FROM daily_account_value WHERE account_id = 1 AND date BETWEEN '2024-01-01' AND '2024-01-05';"
    },
    {
      "question": "What was the AED per unit rate for USD on 2024-01-02?",
      "sql": "SELECT aed_per_unit FROM fx_rates WHERE base_currency = 'USD' AND rate_date = '2024-01-02';"
    },
    {
      "question": "List all currencies available on 2024-01-01.",
      "sql": "SELECT base_currency FROM fx_rates WHERE rate_date = '2024-01-01';"
    },
    {
      "question": "What is the average AED per unit rate across all currencies on 2024-01-01?",
      "sql": "SELECT AVG(aed_per_unit) FROM fx_rates WHERE rate_date = '2024-01-01';"
    },
    {
      "question": "How many merchants are in each category?",
      "sql": "SELECT merchant_category, COUNT(*) AS num_merchants FROM merchants GROUP BY merchant_category;"
    },
    {
      "question": "List all merchant names in the 'Groceries' category.",
      "sql": "SELECT merchant_name FROM merchants WHERE merchant_category = 'Groceries';"
    },
    {
      "question": "Count merchants by country.",
      "sql": "SELECT country, COUNT(*) FROM merchants GROUP BY country;"
    },
    {
      "question": "How many registered users do we have in total?",
      "sql": "SELECT COUNT(*) AS user_count FROM users"
    },
    {
      "question": "Show the three most recently created users (by created_at).",
      "sql": "SELECT user_id, full_name, email, created_at FROM users ORDER BY created_at DESC, user_id DESC LIMIT 3;"
    },
    {
      "question": "Find users whose name contains 'ali' (case-insensitive).",
      "sql": "SELECT user_id, full_name, email FROM users WHERE full_name LIKE '%' || 'ali' || '%' COLLATE NOCASE ORDER BY full_name;"
    },
    {
      "question": "How many accounts are currently open (not closed)?",
      "sql": "SELECT COUNT(*) AS open_accounts FROM accounts WHERE closed_at IS NULL;"
    },
    {
      "question": "List all 'savings' accounts with their owners' names.",
      "sql": "SELECT a.account_id, a.account_name, u.full_name, a.currency FROM accounts a JOIN users u ON a.user_id = u.user_id WHERE a.account_type = 'savings' ORDER BY a.account_id;"
    },
    {
      "question": "How many accounts exist per currency?",
      "sql": "SELECT currency, COUNT(*) AS cnt FROM accounts GROUP BY currency ORDER BY cnt DESC;"
    },
    {
      "question": "Which accounts have a negative starting balance?",
      "sql": "SELECT account_id, user_id, account_name, starting_balance FROM accounts WHERE starting_balance < 0 ORDER BY starting_balance;"
    },
    {
      "question": "Show all accounts owned by 'Allison Hill'.",
      "sql": "SELECT a.account_id, a.account_type, a.account_name, a.currency, a.opened_at, a.closed_at FROM accounts a JOIN users u ON a.user_id = u.user_id WHERE u.full_name = 'Allison Hill' COLLATE NOCASE ORDER BY a.account_id;"
    },
    {
      "question": "How many transactions did Allison Hill have in January 2024?",
      "sql": "SELECT COUNT(*) AS transaction_count FROM transactions t JOIN accounts a ON t.account_id = a.account_id JOIN users u ON a.user_id = u.user_id WHERE u.full_name = 'Allison Hill' COLLATE NOCASE AND t.occurred_at >= '2024-01-01' AND t.occurred_at < '2024-02-01';"
    }
  ]
} 